!function(){window.EmberApp=Ember.Application.create({LOG_TRANSITIONS:!0,CROSS_DOMAIN:!0,URL_BASE:"",CSRF_TOKEN:"",REQ_FORGERY_TOKEN:"",getToken:function(){alert("get token")}})}(),function(){EmberApp.ApplicationController=Ember.ArrayController.extend({init:function(){console.log("CSRF APP: "+Ember.$.cookie("csrftoken"))}})}(),function(){EmberApp.RegisterController=Ember.Controller.extend({register:function(){var a={username:this.get("username"),password:this.get("password"),password_confirm:this.get("password_confirm"),email:this.get("email")};console.log(a),console.log("CSRF: "+Ember.$.cookie("csrftoken")),EmberApp.Utils.getToken(function(){a.authenticity_token=EmberApp.CSRF_TOKEN,EmberApp.Utils.setupAjax(),Ember.$.post(EmberApp.URL_BASE+"/signup",a).then(function(a){alert("Got a response: "+a)})})}})}(),function(){EmberApp.Store=DS.Store.extend({adapter:DS.FixtureAdapter.create()})}(),function(){EmberApp.ApplicationRoute=Ember.Route.extend({model:function(){return["red","yellow","blue"]}})}(),function(){EmberApp.Router.map(function(){this.route("register",{path:"/register"})})}(),function(){EmberApp.Utils=Ember.Object.create({getToken:function(a){$.ajax({url:EmberApp.URL_BASE+"/csrf",crossDomain:EmberApp.CROSS_DOMAIN}).done(function(b){alert(b.csrf_token),EmberApp.CSRF_TOKEN=b.csrf_token,$('[name="authenticity_token"]').val(EmberApp.CSRF_TOKEN),$.cookie("csrftoken",b.csrf_token),a()})},setupAjax:function(){$.ajaxSetup({beforeSend:function(a){a.setRequestHeader("X-CSRF-Token",EmberApp.CSRF_TOKEN)}})}})}();